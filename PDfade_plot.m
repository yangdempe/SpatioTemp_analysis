load('PDfade_p1.mat')

hfig=figure();
hold on
imagesc(SIGMA,RE,phases); xlim([0,0.08]); ylim([0,0.08]);  box on
set(gca,'YDir','normal')
shading flat

C0=ones(25,3).*0.5;
C1=[zeros(25,1),ones(25,2)];
C2=[zeros(51,1),(0.95:-0.019:0)',ones(51,1)];
C3=[zeros(25,1),ones(25,1),zeros(25,1)];
C41=ones(51,1).*(1:-0.016:0.2)';
C4=[C41,C41,zeros(51,1)];
Cs=[C0;C1;C2;C3;C4];
colormap(Cs);

h=colorbar('Ticks',[-0.25,0.25,0.5,1,1.5,1.75,2,2.5,3],...
    'TickLabels',{'I','II',sprintf('\\mu=%.1f',mumin),'III',sprintf('\\mu=%.1f',mumax),...
    'IV','\rho_\alpha=0','V','\rho_\alpha=1'});
h.Label.Interpreter='latex';
% title(h,'$\mu$ (m$^{-1}$)','interpreter','latex');

x1 = 0.08;   x2 = 0.0655;     xm = 0.03;
y1 = 0.08;   y2 = 0.064;    
ym1=0.015;   ym2=0.045;
%k0 = 0.623;         % boundary for bistability region
k2 = 0.08/0.0583;     
kr = 3.3;
kt1= 27.5/30;  
kt2= 35.5/30;

plot3([0,x1],     [0,x1.*k0], [11,11],'k--', 'Linewidth',1.5)
plot3([0,y1./k2], [0,y1],     [11,11],'k--','Linewidth',1.5)
plot3([y2./k2,x2],[y2,y2],    [11,11],'r-', 'Linewidth',2.5)
plot3([0,y1/kr],  [0,y1],     [11,11],'k--','Linewidth',1.5)
plot3([xm,xm],    [ym1,ym2],  [20,20],'k-','Linewidth',2)
plot3([0,x1],     [0,x1.*kt1],[11,11],'b--','Linewidth',2)
plot3([x2,x2],    [x2.*kt1,y2],[11,11],'r-', 'Linewidth',2.5)
%plot3([0,y1./kt2],[0,y1],     [11,11],'g--','Linewidth',1.5)

%k1 = 0.0656/0.08; 
%km = 28.1/30; 
%plot3([0,x1],     [0,x1.*k1], [11,11],'r--','Linewidth',1.5)
%plot3([0,y2./km], [0,y2],     [11,11],'r--','Linewidth',2.5)


z  = 70;
I  = [0.05,0.02,z];
II  = [0.05,0.055,z];
IIIa= [0.05,0.075,z];
IIIb= [0.015,0.03,z];
IV= [0.015,0.070,z];
V = [0.05,0.045,z];
MS = 80;
scatter3(I(1),I(2),I(3),      MS,'r^','filled');
scatter3(IIa(1),IIa(2),IIa(3),MS,'rv','filled');
scatter3(IIb(1),IIb(2),IIb(3),MS,'r>','filled');
scatter3(III(1),III(2),III(3),MS,'rd','filled');
scatter3(V(1),V(2),V(3),      MS,'ro','filled');

title('Phase Diagram','interpreter','latex')
xlabel('$r_e$ (m)',   'interpreter','latex')
ylabel('$\sigma$ (m)','interpreter','latex')
set(gca,'fontsize',20,'CLim',[0,3])

tl = 0.07;  % length
th = 0.076; % height
% Create textbox
annotation(hfig,'textbox',...
    [0.23 0.74 tl th],'String',{'IV'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',20,...
    'FontName','Helvetica Neue',...
    'FitBoxToText','off');

% Create textbox
annotation(hfig,'textbox',...
    [0.48 0.84 tl th],...
    'String',{'IIIa'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',20,...
    'FontName','Helvetica Neue',...
    'FitBoxToText','off');

% Create textbox
annotation(hfig,'textbox',...
    [0.56 0.31 tl th],...
    'String',{'I'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',20,...
    'FontName','Helvetica Neue',...
    'FitBoxToText','off');

% Create textbox
annotation(hfig,'textbox',...
    [0.23 0.44 tl th],...
    'String',{'IIIb'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',20,...
    'FontName','Helvetica Neue',...
    'FitBoxToText','off');

% Create textbox
annotation(hfig,'textbox',...
    [0.56 0.64 tl th],...
    'String',{'V'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',20,...
    'FontName','Helvetica Neue',...
    'FitBoxToText','off');

% Create textbox
annotation(hfig,'textbox',...
    [0.62 0.87 0.2 0.08],...
    'Color',[1 0 0],...
    'String',{'Edge effect'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Helvetica Neue',...
    'FitBoxToText','off',...
    'BackgroundColor',[1 1 1]);

h=annotation(hfig,'textarrow',...
    [0.52 0.42],...
    [0.59 0.59],...
    'string','Bistable',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Helvetica Neue',...
    'HeadStyle','none','LineStyle', 'none','TextRotation',35);

scatter3(IV(1),IV(2),IV(3),   MS,'rs','filled');
% % Create textbox
annotation(hfig,'textbox',...
    [0.55 0.55 tl th],...
    'String',{'II'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',20,...
    'FontName','Helvetica Neue',...
    'FitBoxToText','off');

savefig('PDfade_p1_fit.fig');

